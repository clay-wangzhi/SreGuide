import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as l,c as o,a as n,b as s,d as e,e as i}from"./app-de4b287a.js";const c={},u=n("h1",{id:"_4-1-å¼€å§‹ç¼–å†™jenkinsfile",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_4-1-å¼€å§‹ç¼–å†™jenkinsfile","aria-hidden":"true"},"#"),s(" 4.1 å¼€å§‹ç¼–å†™Jenkinsfile")],-1),r={href:"http://docs.idevops.site/jenkins/pipelinesyntax/chapter01/",target:"_blank",rel:"noopener noreferrer"},d=i('<p>æ‚¨å¥½ï¼Œè¿˜åœ¨ç–‘æƒ‘ä»€ä¹ˆæ˜¯æµæ°´çº¿å—ï¼Ÿ æœ¬ç« æˆ‘ä»¬å°†å‘Šè¯‰æ‚¨å¦‚ä½•è¿è¡Œä¸€æ¡æµæ°´çº¿ èµ¶å¿«å­¦ä¹ å§ï¼ ğŸ˜€</p><hr><h2 id="ä¸ºä»€ä¹ˆä½¿ç”¨pipeline" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆä½¿ç”¨pipeline" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆä½¿ç”¨pipeline?</h2><p>æœ¬è´¨ä¸Šï¼Œjenkinsæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å¼•æ“ï¼Œå®ƒæ”¯æŒè®¸å¤šè‡ªåŠ¨æ¨¡å¼ã€‚æµæ°´çº¿å‘Jenkinsæ·»åŠ äº†ä¸€ç»„å¼ºå¤§çš„å·¥å…·ï¼Œæ”¯æŒç”¨ä¾‹ã€ç®€å•çš„æŒç»­é›†æˆåˆ°å…¨é¢çš„æŒç»­äº¤ä»˜æµæ°´çº¿ã€‚ é€šè¿‡å¯¹ä¸€ç³»åˆ—çš„å‘å¸ƒä»»åŠ¡å»ºç«‹æ ‡å‡†çš„æ¨¡æ¿ï¼Œç”¨æˆ·å¯ä»¥åˆ©ç”¨æ›´å¤šæµæ°´çº¿çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ï¼š</p><ul><li>ä»£ç åŒ–: æµæ°´çº¿æ˜¯åœ¨ä»£ç ä¸­å®ç°çš„ï¼Œé€šå¸¸ä¼šå­˜æ”¾åˆ°æºä»£ç æ§åˆ¶ï¼Œä½¿å›¢é˜Ÿå…·æœ‰ç¼–è¾‘ã€å®¡æŸ¥å’Œæ›´æ–°ä»–ä»¬é¡¹ç›®çš„äº¤ä»˜æµæ°´çº¿çš„èƒ½åŠ›ã€‚</li><li>è€ç”¨æ€§ï¼šæµæ°´çº¿å¯ä»¥ä»Jenkinsçš„masterèŠ‚ç‚¹é‡å¯åç»§ç»­è¿è¡Œã€‚</li><li>å¯æš‚åœçš„ï¼šæµæ°´çº¿å¯ä»¥ç”±äººåŠŸè¾“å…¥æˆ–æ‰¹å‡†ç»§ç»­æ‰§è¡Œæµæ°´çº¿ã€‚</li><li>è§£å†³å¤æ‚å‘å¸ƒï¼š æ”¯æŒå¤æ‚çš„äº¤ä»˜æµç¨‹ã€‚ä¾‹å¦‚å¾ªç¯ã€å¹¶è¡Œæ‰§è¡Œã€‚</li><li>å¯æ‰©å±•æ€§ï¼š æ”¯æŒæ‰©å±•DSLå’Œå…¶ä»–æ’ä»¶é›†æˆã€‚</li></ul><p>æ„å»ºä¸€ä¸ªå¯æ‰©å±•æ˜¯Jenkinsçš„æ ¸å¿ƒä»·å€¼ï¼Œæµæ°´çº¿å¯ä»¥é€šè¿‡ShareLibraryçš„æ–¹å¼æ¥æ‰©å±•ã€‚</p><h2 id="pipelineå®šä¹‰" tabindex="-1"><a class="header-anchor" href="#pipelineå®šä¹‰" aria-hidden="true">#</a> pipelineå®šä¹‰</h2><p>å…³äºJenkinsæµæ°´çº¿çš„è¿è¡Œæˆ‘ä»¬å¯ä»¥æŠ½è±¡ä¸€ä¸‹ï¼Œä¾‹å¦‚ï¼šå¯ä»¥æŠŠæµæ°´çº¿(pipeline)æƒ³è±¡æˆ13å·çº¿åœ°é“ï¼ŒæŠŠæµæ°´çº¿çš„é˜¶æ®µ(stage)æƒ³è±¡æˆåœ°é“çš„æ¯ä¸€ä¸ªç«™ç‚¹ï¼ŒæŠŠæµæ°´çº¿è„šæœ¬(jenkinsfile)æƒ³è±¡æˆåœ°é“çº¿è·¯å›¾ã€‚è¿™å°±æ˜¯æµæ°´çº¿çš„å¤šæ ·æ€§ï¼Œæ¯æ¡çº¿è·¯éƒ½æœ‰ä¸åŒçš„ç«™ç‚¹ã€‚</p>',8),k={href:"http://docs.idevops.site/jenkins/pipelinesyntax/chapter01/images/01-subwaybeijing.jpg",target:"_blank",rel:"noopener noreferrer"},v=n("img",{src:"http://docs.idevops.site/jenkins/pipelinesyntax/chapter01/images/01-subwaybeijing.jpg",alt:"images"},null,-1),m=i(`<p>ç°åœ¨åœ°é“ï¼ˆJenkinsï¼‰å·²ç»æœ‰äº†ï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡åœ°é“çš„è¿è¡Œçº¿è·¯å›¾ï¼ˆJenkinsfileï¼‰ï¼Œåœ¨çº¿è·¯å›¾ä¸­æŒ‡å®šè¦ç»è¿‡çš„ç«™ç‚¹ï¼ˆstagesï¼‰ã€‚è¿™ä¸‹ä½ æ˜¯å¦å·²ç»çŸ¥é“æˆ‘ä»¬è¦è¿è¡Œä¸€æ¡æµæ°´çº¿ï¼Œéœ€è¦å…ˆåšä»€ä¹ˆå‘¢ï¼Ÿ â€“ç¼–å†™jenkinsfile</p><p>Pipeline</p><ul><li>Jenkinsçš„Pipelineé€šè¿‡Jenkinsfileè¿›è¡Œæè¿°ï¼ˆç±»ä¼¼äºDockerfileï¼‰</li><li>Jenkinsfileæ˜¯Jenkinsçš„ç‰¹æ€§ï¼ˆpipeline as codeï¼‰</li><li>Pipelineæ˜¯Jenkinsçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæä¾›ä¸€ç»„å¯æ‰©å±•çš„å·¥å…·ã€‚</li><li>é€šè¿‡Pipeline çš„DSLï¼ˆPipeline Domain Specific Languageï¼‰è¯­æ³•å¯ä»¥å®Œæˆä»ç®€å•åˆ°å¤æ‚çš„äº¤ä»˜æµæ°´çº¿å®ç°ã€‚</li></ul><p>Jenkinsfile</p><ul><li>Jenkinsfileä½¿ç”¨ä¸¤ç§è¯­æ³•è¿›è¡Œç¼–å†™ï¼Œåˆ†åˆ«æ˜¯å£°æ˜å¼å’Œè„šæœ¬å¼ã€‚</li><li>å£°æ˜å¼å’Œè„šæœ¬å¼çš„æµæ°´çº¿ä»æ ¹æœ¬ä¸Šæ˜¯ä¸åŒçš„ã€‚</li><li>å£°æ˜å¼æ˜¯jenkinsæµæ°´çº¿æ›´å‹å¥½çš„ç‰¹æ€§ã€‚</li><li>è„šæœ¬å¼çš„æµæ°´çº¿è¯­æ³•ï¼Œæä¾›æ›´ä¸°å¯Œçš„è¯­æ³•ç‰¹æ€§ã€‚</li><li>å£°æ˜å¼æµæ°´çº¿ä½¿ç¼–å†™å’Œè¯»å–æµæ°´çº¿ä»£ç æ›´å®¹æ˜“è®¾è®¡ã€‚</li></ul><h2 id="pipelineæ¼”ç¤º" tabindex="-1"><a class="header-anchor" href="#pipelineæ¼”ç¤º" aria-hidden="true">#</a> pipelineæ¼”ç¤º</h2><p>æ¥æˆ‘ä»¬ä¸€èµ·çœ‹ä¸‹è¿™é‡Œçš„é…ç½®ï¼Œçœ‹ä¸‹Jenkinsfileçš„ç»„æˆåŠæ¯ä¸ªéƒ¨åˆ†çš„åŠŸèƒ½å«ä¹‰ã€‚</p><ul><li>ä½¿ç”¨agent{}ï¼ŒæŒ‡å®šnodeèŠ‚ç‚¹/workspaceï¼ˆå®šä¹‰å¥½æ­¤æµæ°´çº¿åœ¨æŸèŠ‚ç‚¹è¿è¡Œï¼‰</li><li>æŒ‡å®šoptions{}è¿è¡Œé€‰é¡¹ï¼ˆå®šä¹‰å¥½æ­¤æµæ°´çº¿è¿è¡Œæ—¶çš„ä¸€äº›é€‰é¡¹ï¼Œä¾‹å¦‚è¾“å‡ºæ—¥å¿—çš„æ—¶é—´ï¼‰</li><li>æŒ‡å®šstages{}ï¼ˆstagesåŒ…å«å¤šä¸ªstageï¼ŒstageåŒ…å«stepsã€‚æ˜¯æµæ°´çº¿çš„æ¯ä¸ªæ­¥éª¤)</li><li>æŒ‡å®špost{}ï¼ˆå®šä¹‰å¥½æ­¤æµæ°´çº¿è¿è¡ŒæˆåŠŸæˆ–è€…å¤±è´¥åï¼Œæ ¹æ®çŠ¶æ€åšä¸€äº›ä»»åŠ¡ï¼‰</li></ul><div class="language-groovy line-numbers-mode" data-ext="groovy"><pre class="language-groovy"><code>pipeline<span class="token punctuation">{</span>
    <span class="token comment">//æŒ‡å®šè¿è¡Œæ­¤æµæ°´çº¿çš„èŠ‚ç‚¹</span>
    agent <span class="token punctuation">{</span> node <span class="token punctuation">{</span> label <span class="token interpolation-string"><span class="token string">&quot;build&quot;</span></span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    

    <span class="token comment">//æµæ°´çº¿çš„é˜¶æ®µ</span>
    stages<span class="token punctuation">{</span>

        <span class="token comment">//é˜¶æ®µ1 è·å–ä»£ç </span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;CheckOut&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps<span class="token punctuation">{</span>
                script<span class="token punctuation">{</span>
                    <span class="token function">println</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;è·å–ä»£ç &quot;</span></span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;Build&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps<span class="token punctuation">{</span>
                script<span class="token punctuation">{</span>
                    <span class="token function">println</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;è¿è¡Œæ„å»º&quot;</span></span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    post <span class="token punctuation">{</span>
        always<span class="token punctuation">{</span>
            script<span class="token punctuation">{</span>
                <span class="token function">println</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;æµæ°´çº¿ç»“æŸåï¼Œç»å¸¸åšçš„äº‹æƒ…&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        success<span class="token punctuation">{</span>
            script<span class="token punctuation">{</span>
                <span class="token function">println</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;æµæ°´çº¿æˆåŠŸåï¼Œè¦åšçš„äº‹æƒ…&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        
        <span class="token punctuation">}</span>
        failure<span class="token punctuation">{</span>
            script<span class="token punctuation">{</span>
                <span class="token function">println</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;æµæ°´çº¿å¤±è´¥åï¼Œè¦åšçš„äº‹æƒ…&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        aborted<span class="token punctuation">{</span>
            script<span class="token punctuation">{</span>
                <span class="token function">println</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;æµæ°´çº¿å–æ¶ˆåï¼Œè¦åšçš„äº‹æƒ…&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="éªŒè¯æµæ°´çº¿æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#éªŒè¯æµæ°´çº¿æ•ˆæœ" aria-hidden="true">#</a> éªŒè¯æµæ°´çº¿æ•ˆæœ</h2>`,10),b={href:"http://docs.idevops.site/jenkins/pipelinesyntax/chapter01/images/03-jenkinslog.png",target:"_blank",rel:"noopener noreferrer"},h=n("img",{src:"http://docs.idevops.site/jenkins/pipelinesyntax/chapter01/images/03-jenkinslog.png",alt:"images"},null,-1),g={href:"http://docs.idevops.site/jenkins/pipelinesyntax/chapter01/images/02-blueocean.png",target:"_blank",rel:"noopener noreferrer"},f=n("img",{src:"http://docs.idevops.site/jenkins/pipelinesyntax/chapter01/images/02-blueocean.png",alt:"images"},null,-1),_=n("p",null,"åˆ°æ­¤ä¸€ä¸ªç®€å•çš„Jenkinfileå®Œæˆäº†ï¼ åé¢æˆ‘ä»¬æ¥è¯¦ç»†åˆ†ææ¯ä¸ªæ­¥éª¤çš„ä½œç”¨ã€‚",-1);function j(q,x){const a=p("ExternalLinkIcon");return l(),o("div",null,[u,n("blockquote",null,[n("p",null,[s("æœ¬æ–‡è½¬è‡ªï¼š"),n("a",r,[s("å¼€å§‹ç¼–å†™ Jenkinsfile | æ³½é˜³"),e(a)])])]),d,n("p",null,[n("a",k,[v,e(a)])]),m,n("p",null,[s("æŸ¥çœ‹Jenkinsæ„å»ºæ—¥å¿—ï¼ˆæ­£ç¡®æ•ˆæœï¼‰"),n("a",b,[h,e(a)])]),n("p",null,[s("é€šè¿‡BlueOceanæŸ¥çœ‹ï¼ˆå¦‚æœæ²¡æœ‰BlueOceanå›¾æ ‡ï¼Œéœ€è¦è‡ªè¡Œåœ¨æ’ä»¶ä¸­å¿ƒå®‰è£…æ’ä»¶ï¼‰"),n("a",g,[f,e(a)])]),_])}const B=t(c,[["render",j],["__file","start-jenkinsfile.html.vue"]]);export{B as default};
