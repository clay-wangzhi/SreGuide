import{_ as r,r as l,c,a as e,b as a,F as t,e as p,d as n,o}from"./app.741e01f1.js";const i={},d=p(`<h1 id="rancher-\u5B89\u88C5\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#rancher-\u5B89\u88C5\u914D\u7F6E" aria-hidden="true">#</a> Rancher \u5B89\u88C5\u914D\u7F6E</h1><h2 id="\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5" aria-hidden="true">#</a> \u5B89\u88C5</h2><p>\u6DFB\u52A0 Helm Chart \u4ED3\u5E93</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>helm repo <span class="token function">add</span> rancher-stable http://rancher-mirror.oss-cn-beijing.aliyuncs.com/server-charts/stable
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u4E3A Rancher \u521B\u5EFA Namespace</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl create namespace cattle-system
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u6DFB\u52A0 TLS \u5BC6\u6587</p><blockquote><p>\u4E0B\u8F7D nginx \u4F7F\u7528\u7684 key \u548C pem \u4F20\u5230\u670D\u52A1\u5668\uFF0C\u5E76\u91CD\u547D\u540D\u4E3A tls.xxx</p><p>\u4F7F\u7528openssl\u628Apem\u8BC1\u4E66\u8F6C\u6362\u4E3Acrt</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>openssl x509 -in  tls.pem -out tls.crt
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div></blockquote><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl -n cattle-system create secret tls tls-rancher-ingress   --cert<span class="token operator">=</span>tls.crt   --key<span class="token operator">=</span>tls.key
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u901A\u8FC7 helm \u5B89\u88C5 rancher</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>helm pull rancher-stable/rancher --version <span class="token number">2.5</span>.12
<span class="token function">tar</span> -xvf rancher-2.5.12.tgz
<span class="token builtin class-name">cd</span> rancher/
<span class="token comment"># rancher.xxx.xxx \u4E3A\u7533\u8BF7\u7684\u57DF\u540D</span>
helm -n cattle-system <span class="token function">install</span> rancher ./ --set <span class="token assign-left variable">hostname</span><span class="token operator">=</span>rancher.xxx.xxx --set <span class="token assign-left variable">replicas</span><span class="token operator">=</span><span class="token number">3</span> --set ingress.tls.source<span class="token operator">=</span>secret
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u9A8C\u8BC1 Rancher Server \u662F\u5426\u5B89\u6210\u529F</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl -n cattle-system rollout status deploy/rancher
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u4FDD\u5B58\u4F7F\u7528\u9009\u9879</p><p>\u8BF7\u4FDD\u5B58\u60A8\u4F7F\u7528\u7684\u5168\u90E8<code>--set</code>\u9009\u9879\u3002\u4F7F\u7528 Helm \u5347\u7EA7 Rancher \u5230\u65B0\u7248\u672C\u65F6\uFF0C\u60A8\u5C06\u9700\u8981\u4F7F\u7528\u76F8\u540C\u7684\u9009\u9879\u3002</p><blockquote><p>\u26A0\uFE0F</p><p>\u5982\u679C\u5916\u5C42\u8FD8\u6709nginx\uFF0Cproxy_pass \u534F\u8BAE\u7528https \u5E76\u52A0\u4E0A websocket \u7684\u4E00\u4E9B\u53C2\u6570</p><div class="language-tex ext-tex line-numbers-mode"><pre class="language-tex"><code>proxy_set_header Host <span class="token equation string">$host;
proxy_set_header X-Real_IP $</span>remote_addr;
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection upgrade;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></blockquote><h2 id="\u5C0F\u6280\u5DE7" tabindex="-1"><a class="header-anchor" href="#\u5C0F\u6280\u5DE7" aria-hidden="true">#</a> \u5C0F\u6280\u5DE7</h2><p>\u91CD\u7F6E rancher admin\u5BC6\u7801</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubectl <span class="token builtin class-name">exec</span> -it rancher-65bd74d789-748wj -n cattle-system -- reset-password
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u53C2\u8003\u6587\u7AE0\uFF1A</p>`,20),h={href:"http://docs.rancher.cn/docs/rancher2/installation/install-rancher-on-k8s/_index",target:"_blank",rel:"noopener noreferrer"},u=n("Rnacher \u9AD8\u53EF\u7528\u5B89\u88C5 | Rancher Doc"),b={href:"http://docs.rancher.cn/docs/rancher2.5/installation/resources/tls-secrets/_index/",target:"_blank",rel:"noopener noreferrer"},m=n("\u6DFB\u52A0 TLS \u5BC6\u6587 | Rancher Doc ");function x(g,v){const s=l("ExternalLinkIcon");return o(),c(t,null,[d,e("p",null,[e("a",h,[u,a(s)])]),e("p",null,[e("a",b,[m,a(s)])])],64)}var k=r(i,[["render",x],["__file","rancher-install.html.vue"]]);export{k as default};
