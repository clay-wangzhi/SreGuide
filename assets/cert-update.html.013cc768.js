import{_ as e,e as s}from"./app.741e01f1.js";const a={},n=s(`<h1 id="\u4F7F\u7528-kubeadm-\u624B\u52A8\u66F4\u65B0\u8BC1\u4E66" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-kubeadm-\u624B\u52A8\u66F4\u65B0\u8BC1\u4E66" aria-hidden="true">#</a> \u4F7F\u7528 kubeadm \u624B\u52A8\u66F4\u65B0\u8BC1\u4E66</h1><p>\u80CC\u666F\uFF1AK8S \u5404\u4E2A\u7EC4\u4EF6\u9700\u8981\u4E0E api-server \u8FDB\u884C\u901A\u4FE1\uFF0C\u901A\u4FE1\u4F7F\u7528\u7684\u8BC1\u4E66\u90FD\u5B58\u653E\u5728 /etc/kubernetes/pki \u8DEF\u5F84\u4E0B\uFF0Ckubeadm \u751F\u6210\u7684\u8BC1\u4E66\u9ED8\u8BA4\u6709\u6548\u4E3A 1 \u5E74\uFF0C\u56E0\u6B64\u9700\u8981\u5B9A\u65F6\u66F4\u65B0\u8BC1\u4E66\uFF0C\u5426\u5219\u8BC1\u4E66\u5230\u671F\u4F1A\u5BFC\u81F4\u6574\u4E2A\u96C6\u7FA4\u4E0D\u53EF\u7528\u3002 \u81EA\u52A8\u66F4\u65B0\u8BC1\u4E66\uFF0CKubenetes \u5728\u5347\u7EA7\u63A7\u5236\u9762\u677F\u76F8\u5173\u7EC4\u4EF6\u65F6\u4F1A\u4E3B\u52A8\u66F4\u65B0\u8BC1\u4E66\uFF0C\u56E0\u6B64\u5982\u679C\u4FDD\u8BC1 Kubernetes \u80FD\u591F\u5B9A\u671F\uFF08\u4E00\u5E74\u4EE5\u5185\uFF09\u5347\u7EA7\u7684\u8BDD\uFF0C\u8BC1\u4E66\u4F1A\u81EA\u52A8\u66F4\u65B0\u3002</p><p>\u73AF\u5883\u8BF4\u660E\uFF1Ak8s 1.18.10</p><p>\u4EE5\u4E0B\u6B65\u9AA4\uFF0C\u5728\u6240\u6709 master \u8282\u70B9\u6267\u884C</p><p>\u5177\u4F53\u64CD\u4F5C\u6B65\u9AA4 1\uFF09\u68C0\u67E5\u8BC1\u4E66\u662F\u5426\u8FC7\u671F\uFF0C\u4EE5\u4E0B\u4E24\u4E2A\u547D\u4EE4\u5747\u53EF</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm alpha certs check-expiration
openssl x509 -in /etc/kubernetes/pki/apiserver.crt -noout -text <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">&#39; Not &#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2\uFF09\u8BC1\u4E66\u3001\u914D\u7F6E\u6587\u4EF6\u7B49\u5907\u4EFD</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> -rp /etc/kubernetes /etc/kubernetes.bak
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>3\uFF09\u91CD\u65B0\u751F\u6210\u8BC1\u4E66</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm alpha certs renew all
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>4\uFF09\u91CD\u65B0\u751F\u6210\u914D\u7F6E\u6587\u4EF6</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm init phase kubeconfig all
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>5\uFF09\u91CD\u542F kubelet\u3001apiserver\u3001scheduler\u3001controller-manager\u3001etcd</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl restart kubelet
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token operator">|</span> <span class="token function">egrep</span> <span class="token string">&quot;k8s_kube-apiserver|k8s_kube-scheduler|k8s_kube-controller-manager|k8s_etcd&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $1}&#39;</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">docker</span> restart
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>6\uFF09\u66F4\u65B0 admin \u914D\u7F6E</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> /etc/kubernetes/admin.conf ~/.kube/config
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>7\uFF09\u68C0\u67E5\u8BC1\u4E66\u8FC7\u671F\u65F6\u95F4</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>kubeadm alpha certs check-expiration
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>\u5982\u679C\u91CD\u65B0\u751F\u6210\u8FC7\u7A0B\u4E2D\u6709\u9519\u8BEF\uFF0C\u5C31\u628A\u65E7\u6587\u4EF6\u5220\u9664</p></blockquote>`,19);function r(p,c){return n}var l=e(a,[["render",r],["__file","cert-update.html.vue"]]);export{l as default};
