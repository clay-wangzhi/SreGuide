const n=JSON.parse(`{"key":"v-5fdd348e","path":"/web/nginx/config.html","title":"3. nginx配置文件详解","lang":"zh-CN","frontmatter":{"date":"2020-03-20T00:00:00.000Z","category":"web中间件","tag":["Nginx"],"description":"3. nginx配置文件详解 配置文件详解 user nginx; worker_processes 8; worker_cpu_affinity auto; #worker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 01000000 10000000; error_log /var/log/nginx/error.log error; pid /var/run/nginx.pid; worker_rlimit_nofile 65535; events { use epoll; worker_connections 20480; } http { include mime.types; default_type application/octet-stream; log_format prod '$remote_addr|$remote_user|[$time_local]|$request|' '$status|$body_bytes_sent|$http_referer|' '$http_user_agent|$request_time|$host|$upstream_addr|$upstream_response_time'; access_log /var/log/nginx/access.log prod; charset utf-8; fastcgi_intercept_errors on; server_names_hash_bucket_size 256; client_header_buffer_size 32k; large_client_header_buffers 4 128k; server_tokens off; sendfile on; tcp_nopush on; tcp_nodelay on; #支持ssi包含文件 ssi on; ssi_silent_errors on; # ssi_types text/html; keepalive_timeout 90; client_header_timeout 10; client_body_timeout 20; client_max_body_size 200m; client_body_buffer_size 128k; # include /etc/nginx/gzip.conf; gzip on; \\tgzip_buffers 4 8k; \\tgzip_comp_level 6; \\tgzip_disable \\"MSIE [1-6]\\\\.\\"; \\tgzip_http_version 1.1; \\tgzip_min_length 1000; \\tgzip_proxied any; \\tgzip_vary on; \\tgzip_types text/plain text/css application/javascript application/x-javascript text/xml application/xml application/xml+rss text/javascript application/json image/jpeg image/gif image/png image/jpg; # include /etc/nginx/proxy.conf; proxy_connect_timeout 90; \\tproxy_read_timeout 90; \\tproxy_send_timeout 90; \\tproxy_buffer_size 32k; \\tproxy_buffers 4 64k; \\tproxy_busy_buffers_size 128k; # include /etc/nginx/backend.conf; upstream my_server_pool { server 192.168.1.109:80 weight=1 max_fails=2 fail_timeout=30; server 192.168.1.108:80 weight=2 max_fails=2 fail_timeout=30; } include /etc/nginx/conf.d/h5.conf; }","head":[["meta",{"property":"og:url","content":"https://clay-wangzhi.com/web/nginx/config.html"}],["meta",{"property":"og:site_name","content":"SRE运维进阶之路"}],["meta",{"property":"og:title","content":"3. nginx配置文件详解"}],["meta",{"property":"og:description","content":"3. nginx配置文件详解 配置文件详解 user nginx; worker_processes 8; worker_cpu_affinity auto; #worker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 01000000 10000000; error_log /var/log/nginx/error.log error; pid /var/run/nginx.pid; worker_rlimit_nofile 65535; events { use epoll; worker_connections 20480; } http { include mime.types; default_type application/octet-stream; log_format prod '$remote_addr|$remote_user|[$time_local]|$request|' '$status|$body_bytes_sent|$http_referer|' '$http_user_agent|$request_time|$host|$upstream_addr|$upstream_response_time'; access_log /var/log/nginx/access.log prod; charset utf-8; fastcgi_intercept_errors on; server_names_hash_bucket_size 256; client_header_buffer_size 32k; large_client_header_buffers 4 128k; server_tokens off; sendfile on; tcp_nopush on; tcp_nodelay on; #支持ssi包含文件 ssi on; ssi_silent_errors on; # ssi_types text/html; keepalive_timeout 90; client_header_timeout 10; client_body_timeout 20; client_max_body_size 200m; client_body_buffer_size 128k; # include /etc/nginx/gzip.conf; gzip on; \\tgzip_buffers 4 8k; \\tgzip_comp_level 6; \\tgzip_disable \\"MSIE [1-6]\\\\.\\"; \\tgzip_http_version 1.1; \\tgzip_min_length 1000; \\tgzip_proxied any; \\tgzip_vary on; \\tgzip_types text/plain text/css application/javascript application/x-javascript text/xml application/xml application/xml+rss text/javascript application/json image/jpeg image/gif image/png image/jpg; # include /etc/nginx/proxy.conf; proxy_connect_timeout 90; \\tproxy_read_timeout 90; \\tproxy_send_timeout 90; \\tproxy_buffer_size 32k; \\tproxy_buffers 4 64k; \\tproxy_busy_buffers_size 128k; # include /etc/nginx/backend.conf; upstream my_server_pool { server 192.168.1.109:80 weight=1 max_fails=2 fail_timeout=30; server 192.168.1.108:80 weight=2 max_fails=2 fail_timeout=30; } include /etc/nginx/conf.d/h5.conf; }"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-04-19T13:08:31.000Z"}],["meta",{"property":"article:author","content":"Clay"}],["meta",{"property":"article:tag","content":"Nginx"}],["meta",{"property":"article:published_time","content":"2020-03-20T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-04-19T13:08:31.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"3. nginx配置文件详解\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2020-03-20T00:00:00.000Z\\",\\"dateModified\\":\\"2023-04-19T13:08:31.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Clay\\",\\"url\\":\\"https://clay-wangzhi.com\\"}]}"]]},"headers":[{"level":2,"title":"1 样例文件解释","slug":"_1-样例文件解释","link":"#_1-样例文件解释","children":[]},{"level":2,"title":"2 全局变量","slug":"_2-全局变量","link":"#_2-全局变量","children":[]}],"git":{"createdTime":1681909711000,"updatedTime":1681909711000,"contributors":[{"name":"clay-wangzhi","email":"clay.wangzhi@gmail.com","commits":1}]},"readingTime":{"minutes":10.61,"words":3182},"filePathRelative":"web/nginx/config.md","localizedDate":"2020年3月20日","excerpt":"<h1> 3. nginx配置文件详解</h1>\\n<p>配置文件详解</p>\\n<div class=\\"language-nginx line-numbers-mode\\" data-ext=\\"nginx\\"><pre class=\\"language-nginx\\"><code><span class=\\"token directive\\"><span class=\\"token keyword\\">user</span> nginx</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token directive\\"><span class=\\"token keyword\\">worker_processes</span>  <span class=\\"token number\\">8</span></span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token directive\\"><span class=\\"token keyword\\">worker_cpu_affinity</span> auto</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token comment\\">#worker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 01000000 10000000;</span>\\n<span class=\\"token directive\\"><span class=\\"token keyword\\">error_log</span>  /var/log/nginx/error.log  error</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token directive\\"><span class=\\"token keyword\\">pid</span>        /var/run/nginx.pid</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token directive\\"><span class=\\"token keyword\\">worker_rlimit_nofile</span> <span class=\\"token number\\">65535</span></span><span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token directive\\"><span class=\\"token keyword\\">events</span></span> <span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">use</span> epoll</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">worker_connections</span>  <span class=\\"token number\\">20480</span></span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token punctuation\\">}</span>\\n\\n<span class=\\"token directive\\"><span class=\\"token keyword\\">http</span></span> <span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">include</span>       mime.types</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">default_type</span>  application/octet-stream</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">log_format</span>  prod <span class=\\"token string\\">'<span class=\\"token variable\\">$remote_addr|</span><span class=\\"token variable\\">$remote_user|[</span><span class=\\"token variable\\">$time_local]|</span><span class=\\"token variable\\">$request</span>|'</span>\\n                     <span class=\\"token string\\">'<span class=\\"token variable\\">$status</span>|<span class=\\"token variable\\">$body_bytes_sent|</span><span class=\\"token variable\\">$http_referer|</span>'</span>\\n                     <span class=\\"token string\\">'<span class=\\"token variable\\">$http_user_agent|</span><span class=\\"token variable\\">$request_time|</span><span class=\\"token variable\\">$host</span>|<span class=\\"token variable\\">$upstream_addr|</span><span class=\\"token variable\\">$upstream_response_time</span>'</span></span><span class=\\"token punctuation\\">;</span>\\n    \\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">access_log</span>  /var/log/nginx/access.log  prod</span><span class=\\"token punctuation\\">;</span>\\n    \\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">charset</span>  utf-8</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">fastcgi_intercept_errors</span> <span class=\\"token boolean\\">on</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">server_names_hash_bucket_size</span> <span class=\\"token number\\">256</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">client_header_buffer_size</span> <span class=\\"token number\\">32k</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">large_client_header_buffers</span> <span class=\\"token number\\">4</span> <span class=\\"token number\\">128k</span></span><span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">server_tokens</span> <span class=\\"token boolean\\">off</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">sendfile</span> <span class=\\"token boolean\\">on</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">tcp_nopush</span> <span class=\\"token boolean\\">on</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">tcp_nodelay</span> <span class=\\"token boolean\\">on</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token comment\\">#支持ssi包含文件</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">ssi</span> <span class=\\"token boolean\\">on</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">ssi_silent_errors</span> <span class=\\"token boolean\\">on</span></span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token comment\\">#   ssi_types text/html;</span>\\n\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">keepalive_timeout</span>  <span class=\\"token number\\">90</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">client_header_timeout</span> <span class=\\"token number\\">10</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">client_body_timeout</span> <span class=\\"token number\\">20</span></span><span class=\\"token punctuation\\">;</span>\\n    \\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">client_max_body_size</span> <span class=\\"token number\\">200m</span></span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">client_body_buffer_size</span>  <span class=\\"token number\\">128k</span></span><span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token comment\\"># include /etc/nginx/gzip.conf;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">gzip</span> <span class=\\"token boolean\\">on</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">gzip_buffers</span> <span class=\\"token number\\">4</span> <span class=\\"token number\\">8k</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">gzip_comp_level</span> <span class=\\"token number\\">6</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">gzip_disable</span> <span class=\\"token string\\">\\"MSIE [1-6]\\\\.\\"</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">gzip_http_version</span> 1.1</span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">gzip_min_length</span> <span class=\\"token number\\">1000</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">gzip_proxied</span> any</span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">gzip_vary</span> <span class=\\"token boolean\\">on</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">gzip_types</span> text/plain text/css application/javascript application/x-javascript text/xml application/xml application/xml+rss text/javascript application/json image/jpeg image/gif image/png image/jpg</span><span class=\\"token punctuation\\">;</span>\\n    \\n\\n    <span class=\\"token comment\\"># include /etc/nginx/proxy.conf;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">proxy_connect_timeout</span> <span class=\\"token number\\">90</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">proxy_read_timeout</span> <span class=\\"token number\\">90</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">proxy_send_timeout</span> <span class=\\"token number\\">90</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">proxy_buffer_size</span> <span class=\\"token number\\">32k</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">proxy_buffers</span> <span class=\\"token number\\">4</span> <span class=\\"token number\\">64k</span></span><span class=\\"token punctuation\\">;</span>\\n\\t<span class=\\"token directive\\"><span class=\\"token keyword\\">proxy_busy_buffers_size</span> <span class=\\"token number\\">128k</span></span><span class=\\"token punctuation\\">;</span>\\n    \\n    \\n    <span class=\\"token comment\\"># include /etc/nginx/backend.conf;</span>\\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">upstream</span> my_server_pool</span> <span class=\\"token punctuation\\">{</span>\\n        <span class=\\"token directive\\"><span class=\\"token keyword\\">server</span> 192.168.1.109:80 weight=1 max_fails=2 fail_timeout=30</span><span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token directive\\"><span class=\\"token keyword\\">server</span> 192.168.1.108:80 weight=2 max_fails=2 fail_timeout=30</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n    \\n    <span class=\\"token directive\\"><span class=\\"token keyword\\">include</span> /etc/nginx/conf.d/h5.conf</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token punctuation\\">}</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","copyright":{"author":"Clay"},"autoDesc":true}`);export{n as data};
