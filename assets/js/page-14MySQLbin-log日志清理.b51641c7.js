(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1154:function(s,a,e){"use strict";e.r(a);var t=e(1),r=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"_14-mysql-bin-log日志清理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_14-mysql-bin-log日志清理"}},[s._v("#")]),s._v(" 14 MySQL bin-log日志清理")]),s._v(" "),e("h2",{attrs:{id:"自动清理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自动清理"}},[s._v("#")]),s._v(" 自动清理")]),s._v(" "),e("h3",{attrs:{id:"永久生效"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#永久生效"}},[s._v("#")]),s._v(" 永久生效")]),s._v(" "),e("p",[s._v("需要重启mysql才能生效")]),s._v(" "),e("p",[s._v("修改"),e("code",[s._v("my.cnf")]),s._v("文件")]),s._v(" "),e("p",[s._v("添加下面一行")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("expire_logs_days = 7\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"临时生效"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#临时生效"}},[s._v("#")]),s._v(" 临时生效")]),s._v(" "),e("p",[s._v("进入mysql，执行，下面的语句")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("show variables like '%expire_logs_days%';\nset global expire_logs_days = 7;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"手动清理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#手动清理"}},[s._v("#")]),s._v(" 手动清理")]),s._v(" "),e("p",[s._v("进入mysql，查看binlog日志")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("show binary logs;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("删除某个日志文件之前的所有日志文件")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("purge binary logs to 'mysql-bin.000035';\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("清理2019-09-09 13:00:00前binlog日志")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("PURGE MASTER LOGS BEFORE '2019-09-09 13:00:00';\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("清除3天前的bin日志")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("PURGE MASTER LOGS BEFORE DATE_SUB(NOW( ), INTERVAL 3 DAY); \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("注意，不要轻易手动去删除binlog，会导致binlog.index和真实存在的binlog不匹配，而导致expire_logs_day失效")])])])}),[],!1,null,null,null);a.default=r.exports}}]);