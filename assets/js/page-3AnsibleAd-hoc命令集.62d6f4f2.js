(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{936:function(s,a,e){"use strict";e.r(a);var t=e(1),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"_3-ansible-ad-hoc命令集"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-ansible-ad-hoc命令集"}},[s._v("#")]),s._v(" 3 Ansible Ad-hoc命令集")]),s._v(" "),e("h2",{attrs:{id:"_1-ad-hoc简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-ad-hoc简介"}},[s._v("#")]),s._v(" 1 Ad-hoc简介")]),s._v(" "),e("p",[s._v("Ad-Hoc（点对点模式）是指ansible下临时执行的一条命令，并且不需要保存的命令，对于复杂的命令会使用playbook。Ad-hoc的执行依赖于模块，ansible官方提供了大量的模块。 如：command、raw、shell、file、cron等，具体可以通过ansible-doc -l 进行查看 。可以使用ansible-doc -s module来查看某个模块的参数，也可以使用ansible-doc module来查看该模块更详细的信息。")]),s._v(" "),e("h3",{attrs:{id:"_1-1-命令说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-命令说明"}},[s._v("#")]),s._v(" 1.1 命令说明")]),s._v(" "),e("p",[s._v("一个ad-hoc命令的执行，需要按以下格式进行执行：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("ansible 主机或组 -m 模块名 -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'模块参数'")]),s._v("  ansible参数\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("主机和组，是在/etc/ansible/hosts 里进行指定的部分，当然动态Inventory 使用的是脚本从外部应用里获取的主机；")]),s._v(" "),e("li",[s._v("模块名，可以通过ansible-doc -l 查看目前安装的模块，默认不指定时，使用的是command模块，具体可以查看/etc/ansible/ansible.cfg 的“#module_name = command ” 部分，默认模块可以在该配置文件中进行修改；")]),s._v(" "),e("li",[s._v("模块参数，可以通过 “ansible-doc -s 模块名” 查看具体的用法及后面的参数；")]),s._v(" "),e("li",[s._v("ansible参数，可以通过ansible命令的帮助信息里查看到，这里有很多参数可以供选择，如是否需要输入密码、是否sudo等。")])]),s._v(" "),e("h3",{attrs:{id:"_1-2-用户说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-用户说明"}},[s._v("#")]),s._v(" 1.2  用户说明")]),s._v(" "),e("p",[s._v("ansible在执行ad-hoc的时候，需要使用远程管理机上的一个用户身份，默认这个用户是root，而在实际生产环境中，不建议直接使用root，而推荐使用一个普通用户，需要配置该普通用户可通过sudo提权。")]),s._v(" "),e("p",[s._v("下面是一个配置示例：")]),s._v(" "),e("ol",[e("li",[s._v("在被管理机上创建一个普通用户ansible，并配置sudo提权：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 创建ansible用户\nuseradd ansible\n\n# 设置ansible用户可免密提权\nvim /etc/sudoers.d/ansible\nansible    ALL=(ALL)       NOPASSWD:ALL\n\nchmod 400 /etc/sudoers.d/ansible\n\nmkdir /home/ansible/.ssh\nchown ansible.ansible /home/ansible/.ssh\nchmod 700 /home/ansible/.ssh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("ol",[e("li",[s._v("在管理端修改ansible.cfg配置文件如下：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[default]\nremote_user = ansible\nask_pass = False\n\n[privilege_escalation]\nbecome=True\nbecome_method=sudo\nbecome_user=root\nbecome_ask_pass=False\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("ol",[e("li",[s._v("将管理端用户的"),e("code",[s._v("id_rsa.pub")]),s._v("复制到被管理端的"),e("code",[s._v("/home/ansible/.ssh//home/ansible/.ssh/authorized_keys")]),s._v("文件中，并设置该文件的权限为400")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 管理端执行：\nssh-copy-id -i .ssh/id_rsa.pub ansible@db1.example.com\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("blockquote",[e("p",[s._v("需要说明的是，通过上面的操作，需要为ansible用户先创建密码，在实际生产当中，不建议为该用户设置密码。可在安装系统时，提前将管理端公钥直接写入到被管理节点的ansible用户下")])]),s._v(" "),e("h3",{attrs:{id:"_1-3-命令执行模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-命令执行模块"}},[s._v("#")]),s._v(" 1.3 命令执行模块")]),s._v(" "),e("p",[s._v("命令执行模块包含如下 四个模块：")]),s._v(" "),e("ul",[e("li",[s._v('command模块：该模块通过-a跟上要执行的命令可以直接执行，不过命令里如果有带有如下字符部分则执行不成功 “ "<", ">", "|", "&"')]),s._v(" "),e("li",[s._v("shell 模块：用法基本和command一样，但是支持解析特殊shell符号")]),s._v(" "),e("li",[s._v("raw模块：执行底层shell命令。command和shell模块都是通过目标主机上的python代码启动/bin/sh来执行命令的，但目标主机上可能没有安装python，这时只能使用raw模块在远程主机上直接启动/bin/sh来执行命令，通常只有在目标主机上安装python时才使用raw模块，其它时候都不使用该模块")]),s._v(" "),e("li",[s._v("script模块：在远程主机上执行脚本文件，其原理是先将shell 复制到远程主机，再在远程主机上执行")])]),s._v(" "),e("blockquote",[e("p",[s._v("raw模块和comand、shell 模块不同的是其没有chdir、creates、removes参数，chdir参数的作用就是先切到chdir指定的目录后，再执行后面的命令，这在后面很多模块里都会有该参数 。")])]),s._v(" "),e("h2",{attrs:{id:"_2-常用模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-常用模块"}},[s._v("#")]),s._v(" 2 常用模块")]),s._v(" "),e("p",[s._v("根据官方的分类，将模块按功能分类为：云模块、命令模块、数据库模块、文件模块、资产模块、消息模块、监控模块、网络模块、通知模块、包管理模块、源码控制模块、系统模块、单元模块、web设施模块、windows模块 ，具体可以参看官方页面。")]),s._v(" "),e("p",[s._v("这里从官方分类的模块里选择最常用的一些模块进行介绍。")]),s._v(" "),e("h3",{attrs:{id:"_2-1-command模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-command模块"}},[s._v("#")]),s._v(" 2.1 command模块")]),s._v(" "),e("p",[s._v("command模块包含如下选项：")]),s._v(" "),e("ul",[e("li",[s._v("creates：一个文件名，当该文件存在，则该命令不执行")]),s._v(" "),e("li",[s._v("free_form：要执行的linux指令")]),s._v(" "),e("li",[s._v("chdir：在执行指令之前，先切换到该指定的目录")]),s._v(" "),e("li",[s._v("removes：一个文件名，当该文件不存在，则该选项不执行")]),s._v(" "),e("li",[s._v("executable：切换shell来执行指令，该执行路径必须是一个绝对路径")])]),s._v(" "),e("p",[s._v("chdir示例：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 三个命令都会返回执行成功的状态。不过实际上只有前两个文件会被创建成功。使用raw模块的执行的结果文件事实上也被正常创建了，不过不是在chdir指定的目录，而是在当前执行用户的家目录")]),s._v("\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.1 -m "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'chdir=/tmp/test.txt touch test.file'")]),s._v("\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.1 -m shell -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'chdir=/tmp/test.txt touch test2.file'")]),s._v("\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.1 -m raw -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'chdir=/tmp/text.txt touch test3.file'")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("creates与removes示例：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("ansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.1 -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'creates=/tmp/server.txt uptime'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#当/tmp/server.txt文件存在时，则不执行uptime指令")]),s._v("\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.1 -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'removes=/tmp/server.txt uptime'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#当/tmp/server.txt文件不存在时，则不执行uptime指令")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"_2-2-script模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-script模块"}},[s._v("#")]),s._v(" 2.2 script模块")]),s._v(" "),e("p",[s._v("示例：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#要执行的脚本文件script.sh内容如下： ")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#/bin/bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -hT\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行ansible指令：")]),s._v("\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.212")]),s._v(".52.252 -m script -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'script.sh'")]),s._v(" \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_2-3-ping模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-ping模块"}},[s._v("#")]),s._v(" 2.3 ping模块")]),s._v(" "),e("p",[s._v("测试主机是否是通的，用法很简单，不涉及参数：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v(" ansible "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-4-file模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-file模块"}},[s._v("#")]),s._v(" 2.4 file模块")]),s._v(" "),e("p",[s._v("file模块主要用于远程主机上的文件操作，file模块包含如下选项：")]),s._v(" "),e("ul",[e("li",[s._v("force：需要在两种情况下强制创建软链接，一种是源文件不存在但之后会建立的情况下；另一种是目标软链接已存在,需要先取消之前的软链，然后创建新的软链，有两个选项：yes|no")]),s._v(" "),e("li",[s._v("group：定义文件/目录的属组")]),s._v(" "),e("li",[s._v("mode：定义文件/目录的权限")]),s._v(" "),e("li",[s._v("owner：定义文件/目录的属主")]),s._v(" "),e("li",[s._v("path：必选项，定义文件/目录的路径")]),s._v(" "),e("li",[s._v("src：要被链接的源文件的路径，只应用于state=link的情况")]),s._v(" "),e("li",[s._v("dest：被链接到的路径，只应用于state=link的情况")]),s._v(" "),e("li",[s._v("state：\n"),e("ul",[e("li",[s._v("directory：如果目录不存在，创建目录")]),s._v(" "),e("li",[s._v("file：即使文件不存在，也不会被创建")]),s._v(" "),e("li",[s._v("link：创建软链接")]),s._v(" "),e("li",[s._v("hard：创建硬链接")]),s._v(" "),e("li",[s._v("touch：如果文件不存在，则会创建一个新的文件，如果文件或目录已存在，则更新其最后修改时间")]),s._v(" "),e("li",[s._v("absent：删除目录、文件或者取消链接文件")])])])]),s._v(" "),e("p",[s._v("使用示例：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("ansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".8.120 -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path=/tmp/test.txt state=touch owner=root group=root mode=644'")]),s._v("\n\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".8.120 -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'src=/tmp/test.txt dest=/root/test.txt state=link'")]),s._v("\n\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".8.120 -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path=/tmp/test.txt state=file'")]),s._v("\n\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".8.120 -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path=/tmp/test state=directory owner=root group=root mode=755'")]),s._v("\n\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".8.120 -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path=/tmp/test2/test3/aaa/bbb state=directory owner=root group=root mode=755'")]),s._v("\n\nansible "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".8.120 -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path=/tmp/test2 state=absent'")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h3",{attrs:{id:"_2-5-copy模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-copy模块"}},[s._v("#")]),s._v(" 2.5 copy模块")]),s._v(" "),e("p",[s._v("复制文件到远程主机，copy模块包含如下选项：")]),s._v(" "),e("ul",[e("li",[s._v("backup：在覆盖之前将原文件备份，备份文件包含时间信息。有两个选项：yes|no")]),s._v(" "),e("li",[s._v('content：用于替代"src",可以直接设定指定文件的值')]),s._v(" "),e("li",[s._v("dest：必选项。要将源文件复制到的远程主机的绝对路径，如果源文件是一个目录，那么该路径也必须是个目录")]),s._v(" "),e("li",[s._v("force：如果目标主机包含该文件，但内容不同，如果设置为yes，则强制覆盖，如果为no，则只有当目标主机的目标位置不存在该文件时，才复制。默认为yes")]),s._v(" "),e("li",[s._v("others：所有的file模块里的相关文件属性选项都可以在这里使用")]),s._v(" "),e("li",[s._v('src：要复制到远程主机的文件在本地的地址，可以是绝对路径，也可以是相对路径。如果路径是一个目录，它将递归复制。在这种情况下，如果路径使用"/"来结尾，则只复制目录里的内容，如果没有使用"/"来结尾，则包含目录在内的整个内容全部复制，类似于rsync。')])]),s._v(" "),e("p",[s._v("示例如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ansible 192.168.8.120 -m copy -a 'src=/etc/ansible/ansible.cfg dest=/usr/local/src/ owner=root group=root mode=644'\n\nansible 192.168.8.120 -m copy -a 'backup=yes src=/etc/fstab dest=/usr/local/src/ansible.cfg owner=root group=root mode=644'\n\nansible 192.168.8.120 -m copy -a 'content=\"just a test!\" dest=/usr/local/src/test.txt'\n\nansible 192.168.8.120 -m copy -a 'src=/data dest=/usr/local/src/'\n\nansible 192.168.8.120 -m copy -a 'src=/data/ dest=/usr/local/src/'\n\nansible 192.168.8.120 -m copy -a \"src=/mine/sudoers dest=/etc/sudoers validate='visudo -cf %s'\"\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("h3",{attrs:{id:"_2-6-yum模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-yum模块"}},[s._v("#")]),s._v(" 2.6 yum模块")]),s._v(" "),e("p",[s._v("使用yum包管理器来管理软件包，其选项有：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("name")]),s._v("：要进行操作的软件包的名字，也可以传递一个url或者一个本地的rpm包的路径")]),s._v(" "),e("li",[e("code",[s._v("state")]),s._v("：状态（present，absent，latest）")])]),s._v(" "),e("p",[s._v("示例如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ansible test -m yum -a 'name=httpd state=latest'\nansible test -m yum -a 'name=\"@Development tools\" state=present'\nansible test -m yum -a 'name=http://nginx.org/packages/centos/6/noarch/RPMS/nginx-release-centos-6-0.el6.ngx.noarch.rpm state=present'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_2-7-service模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-service模块"}},[s._v("#")]),s._v(" 2.7 service模块")]),s._v(" "),e("p",[s._v("用于管理服务\n该模块包含如下选项：")]),s._v(" "),e("ul",[e("li",[s._v("arguments：给命令行提供一些选项")]),s._v(" "),e("li",[s._v("enabled：是否开机启动 yes|no")]),s._v(" "),e("li",[s._v("name：必选项，服务名称")]),s._v(" "),e("li",[s._v("pattern：定义一个模式，如果通过status指令来查看服务的状态时，没有响应，就会通过ps指令在进程中根据该模式进行查找，如果匹配到，则认为该服务依然在运行")]),s._v(" "),e("li",[s._v("runlevel：运行级别")]),s._v(" "),e("li",[s._v("sleep：如果执行了restarted，在则stop和start之间沉睡几秒钟")]),s._v(" "),e("li",[s._v("state：对当前服务执行启动，停止、重启、重新加载等操作（started,stopped,restarted,reloaded）")]),s._v(" "),e("li",[s._v("daemon_reload：针对使用systemd的系统，重新加载systemd配置，yes/no")])]),s._v(" "),e("p",[s._v("使用示例：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('ansible test -m service -a "name=httpd state=started enabled=yes"\nasnible test -m service -a "name=foo pattern=/usr/bin/foo state=started"\nansible test -m service -a "name=network state=restarted args=eth0"\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_2-8-cron模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-cron模块"}},[s._v("#")]),s._v(" 2.8 cron模块")]),s._v(" "),e("p",[s._v("用于管理计划任务")]),s._v(" "),e("p",[s._v("包含如下选项：")]),s._v(" "),e("ul",[e("li",[s._v("backup：对远程主机上的原任务计划内容修改之前做备份")]),s._v(" "),e("li",[s._v("cron_file：如果指定该选项，则用该文件替换远程主机上的cron.d目录下的用户的任务计划")]),s._v(" "),e("li",[s._v("day：日（1-31，"),e("em",[s._v("，")]),s._v("/2,……）")]),s._v(" "),e("li",[s._v("hour：小时（0-23，"),e("em",[s._v("，")]),s._v("/2，……）")]),s._v(" "),e("li",[s._v("minute：分钟（0-59，"),e("em",[s._v("，")]),s._v("/2，……）")]),s._v(" "),e("li",[s._v("month：月（1-12，"),e("em",[s._v("，")]),s._v("/2，……）")]),s._v(" "),e("li",[s._v("weekday：周（0-7，*，……）")]),s._v(" "),e("li",[s._v("job：要执行的任务，依赖于state=present")]),s._v(" "),e("li",[s._v("name：该任务的描述")]),s._v(" "),e("li",[s._v("special_time：指定什么时候执行，参数：reboot,yearly,annually,monthly,weekly,daily,hourly")]),s._v(" "),e("li",[s._v("state：确认该任务计划是创建还是删除")]),s._v(" "),e("li",[s._v("user：以哪个用户的身份执行")])]),s._v(" "),e("p",[s._v("示例：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("ansible "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'name="a job for reboot" special_time=reboot job="/some/job.sh"\'')]),s._v("\nansible "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'name="yum autoupdate" weekday="2" minute=0 hour=12 user="root"\'')]),s._v("\nansible "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v("  -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'backup="True" name="test" minute="0" hour="5,2" job="ls -alh > /dev/null"\'')]),s._v("\nansilbe "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cron_file=ansible_yum-autoupdate state=absent'")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_2-9-user模块与group模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-user模块与group模块"}},[s._v("#")]),s._v(" 2.9 user模块与group模块")]),s._v(" "),e("p",[s._v("user模块是请求的是useradd, userdel, usermod三个指令，goup模块请求的是groupadd, groupdel, groupmod 三个指令。")]),s._v(" "),e("h4",{attrs:{id:"_2-9-1-user模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-1-user模块"}},[s._v("#")]),s._v(" 2.9.1 user模块")]),s._v(" "),e("ul",[e("li",[s._v("home：指定用户的家目录，需要与createhome配合使用")]),s._v(" "),e("li",[s._v("groups：指定用户的属组")]),s._v(" "),e("li",[s._v("uid：指定用的uid")]),s._v(" "),e("li",[s._v("password：指定用户的密码")]),s._v(" "),e("li",[s._v("name：指定用户名")]),s._v(" "),e("li",[s._v("createhome：是否创建家目录 yes|no")]),s._v(" "),e("li",[s._v("system：是否为系统用户")]),s._v(" "),e("li",[s._v("remove：当state=absent时，remove=yes则表示连同家目录一起删除，等价于userdel -r")]),s._v(" "),e("li",[s._v("state：是创建还是删除")]),s._v(" "),e("li",[s._v("shell：指定用户的shell环境")])]),s._v(" "),e("p",[s._v("使用示例：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("user: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("johnd "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("comment")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"John Doe"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1040")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("group")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin\nuser: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("james "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("shell")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/bin/bash "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admins,developers "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("append")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes user: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("johnd "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("state")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("absent "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("remove")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\nuser: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("james18 "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("shell")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/bin/zsh "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("developers "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("expires")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1422403387")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#生成密钥时，只会生成公钥文件和私钥文件，和直接使用ssh-keygen指令效果相同，不会生成authorized_keys文件")]),s._v("\nuser: "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("generate_ssh_key")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ssh_key_bits")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ssh_key_file")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".ssh/id_rsa  \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("需要说明的是，在指定password参数时，不能使用明文密码，因为后面这一串密码会被直接传送到被管理主机的/etc/shadow文件中，所以需要先将密码字符串进行加密处理。然后将得到的字符串放到password中即可。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("echo \"123456\" | openssl passwd -1 -salt $(< /dev/urandom tr -dc '[:alnum:]' | head -c 32) -stdin\n$1$4P4PlFuE$ur9ObJiT5iHNrb9QnjaIB0\n\n#使用上面的密码创建用户\nansible all -m user -a 'name=foo password=\"$1$4P4PlFuE$ur9ObJiT5iHNrb9QnjaIB0\"'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("blockquote",[e("p",[s._v("不同的发行版默认使用的加密方式可能会有区别，具体可以查看/etc/login.defs文件确认，centos 6.5版本使用的是SHA512加密算法。")])]),s._v(" "),e("h4",{attrs:{id:"_2-9-2-group示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-2-group示例"}},[s._v("#")]),s._v(" 2.9.2 group示例")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("group: name=somegroup state=present\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-10-synchronize模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-10-synchronize模块"}},[s._v("#")]),s._v(" 2.10 synchronize模块")]),s._v(" "),e("p",[s._v("使用rsync同步文件，其参数如下：")]),s._v(" "),e("ul",[e("li",[s._v("archive: 归档，相当于同时开启recursive(递归)、links、perms、times、owner、group、-D选项都为yes ，默认该项为开启")]),s._v(" "),e("li",[s._v("checksum: 跳过检测sum值，默认关闭")]),s._v(" "),e("li",[s._v("compress:是否开启压缩")]),s._v(" "),e("li",[s._v("copy_links：复制链接文件，默认为no ，注意后面还有一个links参数")]),s._v(" "),e("li",[s._v("delete: 删除不存在的文件，默认no")]),s._v(" "),e("li",[s._v("dest：目录路径")]),s._v(" "),e("li",[s._v("dest_port：默认目录主机上的端口 ，默认是22，走的ssh协议")]),s._v(" "),e("li",[s._v("dirs：传输目录不进行递归，默认为no，即进行目录递归")]),s._v(" "),e("li",[s._v("rsync_opts：rsync参数部分")]),s._v(" "),e("li",[s._v("set_remote_user：主要用于/etc/ansible/hosts中定义或默认使用的用户与rsync使用的用户不同的情况")]),s._v(" "),e("li",[s._v("mode: push或pull 模块，push模的话，一般用于从本机向远程主机上传文件，pull 模式用于从远程主机上取文件")])]),s._v(" "),e("p",[s._v("使用示例：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('src=some/relative/path dest=/some/absolute/path rsync_path="sudo rsync"\nsrc=some/relative/path dest=/some/absolute/path archive=no links=yes\nsrc=some/relative/path dest=/some/absolute/path checksum=yes times=no\nsrc=/tmp/helloworld dest=/var/www/helloword rsync_opts=--no-motd,--exclude=.git mode=pull\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_2-11-filesystem模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-filesystem模块"}},[s._v("#")]),s._v(" 2.11 filesystem模块")]),s._v(" "),e("p",[s._v("在块设备上创建文件系统\n常用选项：")]),s._v(" "),e("ul",[e("li",[s._v("dev：目标块设备")]),s._v(" "),e("li",[s._v("force：在一个已有文件系统 的设备上强制创建")]),s._v(" "),e("li",[s._v("fstype：文件系统的类型")]),s._v(" "),e("li",[s._v("opts：传递给mkfs命令的选项")])]),s._v(" "),e("p",[s._v("示例：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("ansible "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m filesystem -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fstype=ext2 dev=/dev/sdb1 force=yes'")]),s._v("\nansible "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -m filesystem -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fstype=ext4 dev=/dev/sdb1 opts=\"-cc\"'")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"_2-12-mount模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-12-mount模块"}},[s._v("#")]),s._v(" 2.12 mount模块")]),s._v(" "),e("p",[s._v("配置挂载点\n选项：")]),s._v(" "),e("ul",[e("li",[s._v("dump")]),s._v(" "),e("li",[s._v("fstype：必选项，挂载文件的类型")]),s._v(" "),e("li",[s._v("name：必选项，挂载点")]),s._v(" "),e("li",[s._v("opts：传递给mount命令的参数")]),s._v(" "),e("li",[s._v("src：必选项，要挂载的文件")]),s._v(" "),e("li",[s._v("state：必选项\n"),e("ul",[e("li",[s._v("present：只处理fstab中的配置")]),s._v(" "),e("li",[s._v("absent：删除挂载点")]),s._v(" "),e("li",[s._v("mounted：自动创建挂载点并挂载之")]),s._v(" "),e("li",[s._v("umounted：卸载")])])])]),s._v(" "),e("p",[s._v("示例：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("name=/mnt/dvd src=/dev/sr0 fstype=iso9660 opts=ro state=present\nname=/srv/disk src='LABEL=SOME_LABEL' state=present\nname=/home src='UUID=b3e48f45-f933-4c8e-a700-22a159ec9077' opts=noatime state=present\n\nansible test -a 'dd if=/dev/zero of=/disk.img bs=4k count=1024'\nansible test -a 'losetup /dev/loop0 /disk.img'\nansible test -m filesystem 'fstype=ext4 force=yes opts=-F dev=/dev/loop0'\nansible test -m mount 'name=/mnt src=/dev/loop0 fstype=ext4 state=mounted opts=rw'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"_2-13-get-url-模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-13-get-url-模块"}},[s._v("#")]),s._v(" 2.13 get_url 模块")]),s._v(" "),e("p",[s._v("该模块主要用于从http、ftp、https服务器上下载文件（类似于wget），主要有如下选项：")]),s._v(" "),e("ul",[e("li",[s._v("sha256sum：下载完成后进行sha256 check；")]),s._v(" "),e("li",[s._v("timeout：下载超时时间，默认10s")]),s._v(" "),e("li",[s._v("url：下载的URL")]),s._v(" "),e("li",[s._v("url_password、url_username：主要用于需要用户名密码进行验证的情况")]),s._v(" "),e("li",[s._v("use_proxy：是事使用代理，代理需事先在环境变更中定义")])]),s._v(" "),e("p",[s._v("示例：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("get_url: url=http://example.com/path/file.conf dest=/etc/foo.conf mode=0440\nget_url: url=http://example.com/path/file.conf dest=/etc/foo.conf sha256sum=b5bb9d8014a0f9b1d61e21e796d78dccdf1352f23cd32812f4850b878ae4944c\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"_2-14-unarchive模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-14-unarchive模块"}},[s._v("#")]),s._v(" 2.14 unarchive模块")]),s._v(" "),e("p",[s._v("用于解压文件，模块包含如下选项：")]),s._v(" "),e("ul",[e("li",[s._v("copy：在解压文件之前，是否先将文件复制到远程主机，默认为yes。若为no，则要求目标主机上压缩包必须存在。")]),s._v(" "),e("li",[s._v("creates：指定一个文件名，当该文件存在时，则解压指令不执行")]),s._v(" "),e("li",[s._v("dest：远程主机上的一个路径，即文件解压的路径")]),s._v(" "),e("li",[s._v("group：解压后的目录或文件的属组")]),s._v(" "),e("li",[s._v("list_files：如果为yes，则会列出压缩包里的文件，默认为no，2.0版本新增的选项")]),s._v(" "),e("li",[s._v("mode：解决后文件的权限")]),s._v(" "),e("li",[s._v("src：如果copy为yes，则需要指定压缩文件的源路径")]),s._v(" "),e("li",[s._v("owner：解压后文件或目录的属主")])]),s._v(" "),e("p",[s._v("示例如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("- unarchive: src=foo.tgz dest=/var/lib/foo\n- unarchive: src=/tmp/foo.zip dest=/usr/local/bin copy=no\n- unarchive: src=https://example.com/example.zip dest=/usr/local/bin copy=no\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"_2-15-debug"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-15-debug"}},[s._v("#")]),s._v(" 2.15 debug")]),s._v(" "),e("p",[s._v("用于输出调试一些数据，模块包含如下选项：")]),s._v(" "),e("ul",[e("li",[s._v('msg：可以输出字符串，可以输出变量的值，变量调用需加"{{}}"')]),s._v(" "),e("li",[s._v("var：只能输出变量的值，变量调用无需加任何东西，只需数据变量名称")])]),s._v(" "),e("p",[s._v("示例如下：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ansible localhost -e "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'str=world'")]),s._v(" -m debug -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'msg=\"hello {{str}}\"'")]),s._v("\nlocalhost "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"msg"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n$ ansible localhost -e "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'str=\"hello world\"'")]),s._v(" -m debug -a "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'var=str'")]),s._v("\nlocalhost "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" SUCCESS "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"str"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("blockquote",[e("p",[s._v("参考链接：")]),s._v(" "),e("p",[s._v("https://www.cnblogs.com/breezey/p/8810414.html")]),s._v(" "),e("p",[s._v("https://www.cnblogs.com/breezey/p/8811187.html")]),s._v(" "),e("p",[s._v("https://blog.51cto.com/cloumn/blog/1544")])])])}),[],!1,null,null,null);a.default=n.exports}}]);