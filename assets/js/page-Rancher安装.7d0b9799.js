(window.webpackJsonp=window.webpackJsonp||[]).push([[252],{1005:function(e,s,a){"use strict";a.r(s);var r=a(1),t=Object(r.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"rancher-安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rancher-安装"}},[e._v("#")]),e._v(" Rancher 安装")]),e._v(" "),a("p",[e._v("添加 Helm Chart 仓库")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("helm repo "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" rancher-stable http://rancher-mirror.oss-cn-beijing.aliyuncs.com/server-charts/stable\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("为 Rancher 创建 Namespace")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("kubectl create namespace cattle-system\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("添加 TLS 密文")]),e._v(" "),a("blockquote",[a("p",[e._v("下载nginx使用的key和pem到服务器，并重命名为 tls.xxx")]),e._v(" "),a("p",[e._v("使用openssl把pem证书转换为crt")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("openssl x509 -in  tls.pem -out tls.crt\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("kubectl -n cattle-system create secret tls tls-rancher-ingress   --cert"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("tls.crt   --key"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("tls.key\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("通过 helm 安装 rancher")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("helm -n cattle-system "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" rancher ./ --set "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("hostname")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("rancher.xxx.xxx --set "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("replicas")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v(" --set ingress.tls.source"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("secret\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("blockquote",[a("p",[e._v("rancher.xxx.xxx 为申请的域名")])]),e._v(" "),a("p",[e._v("验证 Rancher Server 是否安成功")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("kubectl -n cattle-system rollout status deploy/rancher\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("保存使用选项")]),e._v(" "),a("p",[e._v("请保存您使用的全部"),a("code",[e._v("--set")]),e._v("选项。使用 Helm 升级 Rancher 到新版本时，您将需要使用相同的选项。")]),e._v(" "),a("p",[e._v("参考文章：")]),e._v(" "),a("p",[a("a",{attrs:{href:"http://docs.rancher.cn/docs/rancher2/installation/install-rancher-on-k8s/_index",target:"_blank",rel:"noopener noreferrer"}},[e._v("Rnacher 高可用安装 | Rancher Doc"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("a",{attrs:{href:"http://docs.rancher.cn/docs/rancher2.5/installation/resources/tls-secrets/_index/",target:"_blank",rel:"noopener noreferrer"}},[e._v("添加 TLS 密文 | Rancher Doc "),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=t.exports}}]);