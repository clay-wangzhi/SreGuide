(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{1310:function(s,t,a){"use strict";a.r(t);var e=a(1),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_6-用户权限和访问控制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-用户权限和访问控制"}},[s._v("#")]),s._v(" 6 用户权限和访问控制")]),s._v(" "),a("h2",{attrs:{id:"_1-用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-用户"}},[s._v("#")]),s._v(" 1 用户")]),s._v(" "),a("h3",{attrs:{id:"_1-1-创建用户并设置密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-创建用户并设置密码"}},[s._v("#")]),s._v(" 1.1 创建用户并设置密码")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("create user aa@localhost identified by '123';//本地用户\ncreate user aa@'%' identified by '123'; //其他远程用户\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"_1-2-重命名用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-重命名用户"}},[s._v("#")]),s._v(" 1.2 重命名用户")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rename user 'test3'@'%' to 'test1'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_1-3-删除用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-删除用户"}},[s._v("#")]),s._v(" 1.3 删除用户")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("drop user 'testUser'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_2-权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-权限"}},[s._v("#")]),s._v(" 2 权限")]),s._v(" "),a("h3",{attrs:{id:"_2-1-授予权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-授予权限"}},[s._v("#")]),s._v(" 2.1 授予权限")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grant 权限 on 库.表 to 用户@主机 identified by '密码'；grant 权限 on 库.表 to 用户@主机 identified by '密码'；\ngrant all on *.* to 'testUser'@'%' identified by '123';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_2-1-1-查询、插入、更新、删除的权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-查询、插入、更新、删除的权限"}},[s._v("#")]),s._v(" 2.1.1 查询、插入、更新、删除的权限")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grant select on testdb.* to 'testUser'@'%';  \ngrant insert on testdb.* to 'testUser'@'%';  #其中*第通配符，表示所有\ngrant update on testdb.* to 'testUser'@'%';\ngrant delete on testdb.* to 'testUser'@'%';\n\n#总结成一条命令\ngrant select,insert,update,delete on testdb.* to 'testUser'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"_2-1-2-创建和删除表、索引、视图、存储过程的权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-创建和删除表、索引、视图、存储过程的权限"}},[s._v("#")]),s._v(" 2.1.2 创建和删除表、索引、视图、存储过程的权限")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grant create on testdb.* to 'testUser'@'%';  #其中*第通配符，表示所有\ngrant alter on testdb.* to 'testUser'@'%';\ngrant drop on testdb.* to 'testUser'@'%';\n\n#总结成一条命令\ngrant create,alter,drop on testdb.* to 'testUser'@'%';\n\n#外键权限\ngrant reference on testdb.* to 'testUser'@'%';\n\n#索引权限\ngrant index on testdb.* to 'testUser'@'%';\n\n#视图权限\ngrant create view on testdb.* to 'testUser'@'%';\ngrant show view on testdb.* to 'testUser'@'%';\n\n#存储过程权限\ngrant create routine on testdb.* to 'testUser'@'%';\ngrant alter routine on testdb.* to 'testUser'@'%';\ngrant execute on testdb.* to 'testUser'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h4",{attrs:{id:"_2-1-3-指定用户管理数据库的权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-指定用户管理数据库的权限"}},[s._v("#")]),s._v(" 2.1.3 指定用户管理数据库的权限")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#仅管理testdb数据库\ngrant all privileges on testdb.* to 'testUser'@'%';\n\n#管理所有数据库\ngrant all privileges on *.* to 'testUser'@'%';\n#其中privileges关键字可省略\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_2-2-权限的作用层次"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-权限的作用层次"}},[s._v("#")]),s._v(" 2.2 权限的作用层次")]),s._v(" "),a("h4",{attrs:{id:"_2-2-1-作用在整个mysql服务器上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-作用在整个mysql服务器上"}},[s._v("#")]),s._v(" 2.2.1 作用在整个MySQL服务器上")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grant all privileges on *.* to 'testUser'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-2-2-作用在单个数据库上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-作用在单个数据库上"}},[s._v("#")]),s._v(" 2.2.2 作用在单个数据库上")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grant all privileges on testdb.* to 'testUser'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-2-3-作用在单个数据表上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-作用在单个数据表上"}},[s._v("#")]),s._v(" 2.2.3 作用在单个数据表上")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grant all privileges on testdb.testTable to 'testUser'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-2-4-作用在单个数据表的若干个列上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-4-作用在单个数据表的若干个列上"}},[s._v("#")]),s._v(" 2.2.4 作用在单个数据表的若干个列上")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grant select(id, name, home, phone) on testdb.testTable to 'testUser'@'%'; #select可以改其他，字段根据实际修改\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-2-5-作用在存储过程、函数上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-5-作用在存储过程、函数上"}},[s._v("#")]),s._v(" 2.2.5 作用在存储过程、函数上")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grant execute on procedure testdb.tsetfunc to 'testUser'@'%';\ngrant execute on function testdb.tsetfunc to 'testUser'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"_2-3-权限刷新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-权限刷新"}},[s._v("#")]),s._v(" 2.3 权限刷新")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("flush privileges;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_2-4-查看权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-查看权限"}},[s._v("#")]),s._v(" 2.4 查看权限")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#查看当前用户的权限\nshow grants;\n\n#查看mysql中其他用户的权限\nshow grants for 'testUser'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_2-5-移除权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-移除权限"}},[s._v("#")]),s._v(" 2.5 移除权限")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("revoke 权限 on 库.表 from 用户@主机;\nrevoke all on *.* from 'testUser'@'%';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"_2-6-mysql授权表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-mysql授权表"}},[s._v("#")]),s._v(" 2.6 mysql授权表")]),s._v(" "),a("p",[s._v("mysql授权表共有5个表：user、db、host、tables_priv和columns_priv。")]),s._v(" "),a("h4",{attrs:{id:"_2-6-1-user表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-1-user表"}},[s._v("#")]),s._v(" 2.6.1 user表")]),s._v(" "),a("p",[s._v("user表列出可以连接服务器的用户及其口令，并且它指定他们有哪种全局（超级用户）权限。在user表启用的任何权限均是全局权限，并适用于所有数据库。")]),s._v(" "),a("h4",{attrs:{id:"_2-6-2-db表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-2-db表"}},[s._v("#")]),s._v(" 2.6.2 db表")]),s._v(" "),a("p",[s._v("db表列出数据库，用户有权限访问它们。在这里指定的权限适用于一个数据库中的所有表。")]),s._v(" "),a("h4",{attrs:{id:"_2-6-2-host表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-2-host表"}},[s._v("#")]),s._v(" 2.6.2 host表")]),s._v(" "),a("p",[s._v("host表与db表结合使用在一个较好层次上控制特定主机对数据库的访问权限，这可能比单独使用db好些。这个表不受GRANT和REVOKE语句的影响，所以，你可能发觉你根本不是用它。")]),s._v(" "),a("h4",{attrs:{id:"_2-6-3-tables-priv表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-3-tables-priv表"}},[s._v("#")]),s._v(" 2.6.3 tables_priv表")]),s._v(" "),a("p",[s._v("tables_priv表指定表级权限，在这里指定的一个权限适用于一个表的所有列。")]),s._v(" "),a("h4",{attrs:{id:"_2-6-4-columns-priv表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-4-columns-priv表"}},[s._v("#")]),s._v(" 2.6.4 columns_priv表")]),s._v(" "),a("p",[s._v("columns_priv表指定列级权限。这里指定的权限适用于一个表的特定列。")]),s._v(" "),a("h3",{attrs:{id:"_2-7-注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-注意事项"}},[s._v("#")]),s._v(" 2.7 注意事项")]),s._v(" "),a("p",[s._v("grant, revoke 用户权限后，该用户只有重新连接 MySQL 数据库，权限才能生效。")]),s._v(" "),a("p",[s._v("如果想让授权的用户，也可以将这些权限 grant 给其他用户，需要选项 "),a("code",[s._v("grant option")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grant all on testdb.* to 'testUser'@'%' with grant option;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_3-密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-密码"}},[s._v("#")]),s._v(" 3 密码")]),s._v(" "),a("h3",{attrs:{id:"_3-1-修改密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-修改密码"}},[s._v("#")]),s._v(" 3.1 修改密码")]),s._v(" "),a("h4",{attrs:{id:"_3-1-1-更新mysql-user表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-更新mysql-user表"}},[s._v("#")]),s._v(" 3.1.1 更新mysql.user表")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# mysql5.7之前\nupdate user set password=password('123456') where user='root';\n# mysql5.7之后\nupdate user set authentication_string=password('123456') where user='root';\nflush privileges;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"_3-1-2-用set-password命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-2-用set-password命令"}},[s._v("#")]),s._v(" 3.1.2 用set password命令")]),s._v(" "),a("p",[s._v("**语法：**set password for ‘用户名'@'登录地址'=password(‘密码')")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("set password for 'root'@'localhost'=password('123456');\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_3-1-3-mysqladmin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-3-mysqladmin"}},[s._v("#")]),s._v(" 3.1.3 mysqladmin")]),s._v(" "),a("p",[s._v("**语法：**mysqladmin -u用户名 -p旧的密码 password 新密码")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysqladmin -uroot -p123456 password 1234abcd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3-2-忘记密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-忘记密码"}},[s._v("#")]),s._v(" 3.2 忘记密码")]),s._v(" "),a("h4",{attrs:{id:"_3-2-1-跳过授权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-跳过授权"}},[s._v("#")]),s._v(" 3.2.1 跳过授权")]),s._v(" "),a("p",[a("code",[s._v("vim /etc/my.cnf")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[mysqld]\nskip-grant-tables\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_3-2-2-重启服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-重启服务"}},[s._v("#")]),s._v(" 3.2.2 重启服务")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("service mysqld restart\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_3-2-3-修改密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-3-修改密码"}},[s._v("#")]),s._v(" 3.2.3 修改密码")]),s._v(" "),a("p",[s._v("此时在终端用mysql命令登录时不需要用户密码，然后按照修改密码的第一种方式将密码修改即可。")]),s._v(" "),a("h4",{attrs:{id:"_3-2-4-还原登录权限跳过检查配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-还原登录权限跳过检查配置"}},[s._v("#")]),s._v(" 3.2.4 还原登录权限跳过检查配置")]),s._v(" "),a("p",[s._v("将my.cnf中mysqld节点的skip-grant-tables配置删除，然后重新启动服务即可。")]),s._v(" "),a("blockquote",[a("p",[s._v("参考链接：")]),s._v(" "),a("p",[s._v("https://blog.csdn.net/a791693310/article/details/81083864")]),s._v(" "),a("p",[s._v("https://www.jb51.net/article/87979.htm")])])])}),[],!1,null,null,null);t.default=r.exports}}]);