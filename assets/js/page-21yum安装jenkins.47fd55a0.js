(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{975:function(n,s,e){"use strict";e.r(s);var a=e(1),t=Object(a.a)({},(function(){var n=this,s=n.$createElement,e=n._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"_2-1-yum-安装-jenkins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-yum-安装-jenkins"}},[n._v("#")]),n._v(" 2.1 yum 安装 jenkins")]),n._v(" "),e("blockquote",[e("p",[n._v("转载自： "),e("a",{attrs:{href:"https://www.kancloud.cn/willseecloud/jenkins/1860531",target:"_blank",rel:"noopener noreferrer"}},[n._v("yum安装jenkins | willseecloud | 看云"),e("OutboundLink")],1)])]),n._v(" "),e("h2",{attrs:{id:"yum安装jenkins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#yum安装jenkins"}},[n._v("#")]),n._v(" yum安装jenkins")]),n._v(" "),e("p",[n._v("官方文档：")]),n._v(" "),e("p",[n._v("https://pkg.jenkins.io/redhat-stable/")]),n._v(" "),e("p",[e("a",{attrs:{href:"http://mirrors.jenkins-ci.org/%EF%BC%8C",target:"_blank",rel:"noopener noreferrer"}},[n._v("http://mirrors.jenkins-ci.org/"),e("OutboundLink")],1)]),n._v(" "),e("p",[n._v("可选择Jenkins长期支持版本或Jenkins每周版本进行安装。")]),n._v(" "),e("p",[e("strong",[n._v("长期支持版本")])]),n._v(" "),e("p",[n._v("每12周从定期发布流中选择一个"),e("a",{attrs:{href:"https://www.jenkins.io/download/lts/",target:"_blank",rel:"noopener noreferrer"}},[n._v("LTS（长期支持）"),e("OutboundLink")],1),n._v("发布作为该时间段的稳定发布。可以从"),e("a",{attrs:{href:"https://pkg.jenkins.io/redhat-stable/",target:"_blank",rel:"noopener noreferrer"}},[e("code",[n._v("redhat-stable")]),e("OutboundLink")],1),n._v("yum存储库安装。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo\nsudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key\nsudo yum upgrade -y\nsudo yum install -y jenkins java-1.8.0-openjdk-devel\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br")])]),e("p",[e("strong",[n._v("每周发布版本")])]),n._v(" "),e("p",[n._v("每周都会产生一个新版本，以向用户和插件开发人员提供错误修复和功能。可以从"),e("a",{attrs:{href:"https://pkg.jenkins.io/redhat/",target:"_blank",rel:"noopener noreferrer"}},[e("code",[n._v("redhat")]),e("OutboundLink")],1),n._v("yum存储库安装。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo\nsudo rpm --import https://pkg.jenkins.io/redhat/jenkins.io.key\nsudo yum upgrade\nsudo yum install -y jenkins java-1.8.0-openjdk-devel\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br")])]),e("p",[e("strong",[n._v("使用国内rpm包安装")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("yum install -y java-11-openjdk-devel\nyum install -y https://mirrors.huaweicloud.com/jenkins/redhat-stable/jenkins-2.235.3-1.1.noarch.rpm\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br")])]),e("p",[n._v("修改jenkins配置文件以自定义端口")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('[root@localhost ~]# cat /etc/sysconfig/jenkins | grep JENKINS_PORT\nJENKINS_PORT="8080"\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br")])]),e("p",[n._v("启动jenkins服务")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("systemctl enable --now jenkins\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br")])]),e("p",[n._v("配置update center")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("export JENKINS_HOME=/var/lib/jenkins\nmkdir $JENKINS_HOME/update-center-rootCAs\ncat > $JENKINS_HOME/update-center-rootCAs/jenkins-update-center-cn-root-ca.crt <<END\n-----BEGIN CERTIFICATE-----\nMIICcTCCAdoCCQD/jZ7AgrzJKTANBgkqhkiG9w0BAQsFADB9MQswCQYDVQQGEwJD\nTjELMAkGA1UECAwCR0QxCzAJBgNVBAcMAlNaMQ4wDAYDVQQKDAV2aWhvbzEMMAoG\nA1UECwwDZGV2MREwDwYDVQQDDAhkZW1vLmNvbTEjMCEGCSqGSIb3DQEJARYUYWRt\naW5AamVua2lucy16aC5jb20wHhcNMTkxMTA5MTA0MDA5WhcNMjIxMTA4MTA0MDA5\nWjB9MQswCQYDVQQGEwJDTjELMAkGA1UECAwCR0QxCzAJBgNVBAcMAlNaMQ4wDAYD\nVQQKDAV2aWhvbzEMMAoGA1UECwwDZGV2MREwDwYDVQQDDAhkZW1vLmNvbTEjMCEG\nCSqGSIb3DQEJARYUYWRtaW5AamVua2lucy16aC5jb20wgZ8wDQYJKoZIhvcNAQEB\nBQADgY0AMIGJAoGBAN+6jN8rCIjVkQ0Q7ZbJLk4IdcHor2WdskOQMhlbR0gOyb4g\nRX+CorjDRjDm6mj2OohqlrtRxLGYxBnXFeQGU7wWjQHyfKDghtP51G/672lXFtzB\nKXukHByHjtzrDxAutKTdolyBCuIDDGJmRk+LavIBY3/Lxh6f0ZQSeCSJYiyxAgMB\nAAEwDQYJKoZIhvcNAQELBQADgYEAD92l26PoJcbl9GojK2L3pyOQjeeDm/vV9e3R\nEgwGmoIQzlubM0mjxpCz1J73nesoAcuplTEps/46L7yoMjptCA3TU9FZAHNQ8dbz\na0vm4CF9841/FIk8tsLtwCT6ivkAi0lXGwhX0FK7FaAyU0nNeo/EPvDwzTim4XDK\n9j1WGpE=\n-----END CERTIFICATE-----\nEND\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br")])]),e("p",[n._v("修改update center地址")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("cp $JENKINS_HOME/hudson.model.UpdateCenter.xml $JENKINS_HOME/hudson.model.UpdateCenter.xml.back\n\nsed -i 's#https://updates.jenkins.io/update-center.json#https://mirrors.huaweicloud.com/jenkins/updates/update-center.json#g' \\\n  $JENKINS_HOME/hudson.model.UpdateCenter.xml\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br")])]),e("p",[n._v("重启jenkins服务")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("systemctl restart jenkins\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br")])]),e("p",[n._v("输入初始化密码并进行配置")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("cat /var/lib/jenkins/secrets/initialAdminPassword\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br")])]),e("p",[n._v("浏览器访问jenkins："),e("a",{attrs:{href:"http://192.168.1.1:8080/",target:"_blank",rel:"noopener noreferrer"}},[n._v("http://192.168.1.1:8080"),e("OutboundLink")],1)]),n._v(" "),e("h2",{attrs:{id:"jenkins配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jenkins配置文件"}},[n._v("#")]),n._v(" jenkins配置文件")]),n._v(" "),e("p",[n._v("jenkins相关目录说明：")]),n._v(" "),e("p",[n._v("/usr/lib/jenkins/ jenkins安装目录，war包会放在这里。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("# ls /usr/lib/jenkins/\njenkins.war\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br")])]),e("p",[n._v("/var/lib/jenkins/")]),n._v(" "),e("p",[n._v("默认的JENKINS_HOME，其中存储了关于构建服务器的配置信息、构建作业、构建产物、插件和其它有用的信息。\n这个目录将会占用大量的磁盘空间。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("# ll /var/lib/jenkins/\ntotal 60\n-rw-r--r-- 1 jenkins jenkins 1640 Aug  1 12:56 config.xml\n-rw-r--r-- 1 jenkins jenkins  156 Aug  1 12:56 hudson.model.UpdateCenter.xml\n-rw------- 1 jenkins jenkins 1712 Aug  1 12:56 identity.key.enc\n-rw-r--r-- 1 jenkins jenkins    7 Aug  1 12:56 jenkins.install.UpgradeWizard.state\n-rw-r--r-- 1 jenkins jenkins  171 Aug  1 12:56 jenkins.telemetry.Correlator.xml\ndrwxr-xr-x 2 jenkins jenkins 4096 Aug  1 12:56 jobs\ndrwxr-xr-x 3 jenkins jenkins 4096 Aug  1 12:56 logs\n-rw-r--r-- 1 jenkins jenkins  907 Aug  1 12:56 nodeMonitors.xml\ndrwxr-xr-x 2 jenkins jenkins 4096 Aug  1 12:56 nodes\ndrwxr-xr-x 2 jenkins jenkins 4096 Aug  1 12:56 plugins\n-rw-r--r-- 1 jenkins jenkins   64 Aug  1 12:56 secret.key\n-rw-r--r-- 1 jenkins jenkins    0 Aug  1 12:56 secret.key.not-so-secret\ndrwx------ 4 jenkins jenkins 4096 Aug  1 12:56 secrets\ndrwxr-xr-x 2 jenkins jenkins 4096 Aug  1 12:56 updates\ndrwxr-xr-x 2 jenkins jenkins 4096 Aug  1 12:56 userContent\ndrwxr-xr-x 3 jenkins jenkins 4096 Aug  1 12:56 users\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br")])]),e("p",[n._v("目录文件说明：")]),n._v(" "),e("ul",[e("li",[n._v("config.xml：jenkins 的核心配置文件")]),n._v(" "),e("li",[n._v("xml： 其它各种工具的配置信息")])]),n._v(" "),e("p",[n._v("fingerprints：跟踪人工操作的痕迹")]),n._v(" "),e("ul",[e("li",[n._v("jobs：构建作业的配置细节，及构建产物和数据")])]),n._v(" "),e("p",[n._v("workspace：jenkins 对当前作业进行构建的地方，\n包含 jenkins 检验过的源码、构建本身生成的所有文件")]),n._v(" "),e("ul",[e("li",[n._v("builds：包含当前作业的构建历史")]),n._v(" "),e("li",[n._v("config.xml：存放当前作业的所有配置细节")]),n._v(" "),e("li",[n._v("nextBuildNumber：下一次构建的 number")]),n._v(" "),e("li",[n._v("lastStable：最后一个稳定构建的链接（成功的构建）")]),n._v(" "),e("li",[n._v("lastSuccessful：最近成功的构建链接（没有任何编译错误）")]),n._v(" "),e("li",[n._v("plugins：存放所有已安装的插件，更新 jenkins 不需要重新安装插件")]),n._v(" "),e("li",[n._v("users：当使用 jenkins 本地用户数据库时，用户信息会存放在这个目录下")]),n._v(" "),e("li",[n._v("updates：存放可用的插件更新")]),n._v(" "),e("li",[n._v("userContent：存放用户自己为 jenkins 服务器定制化的一些内容")]),n._v(" "),e("li",[n._v("war：存放扩展的 web 应用程序，当以单机应用程序的形式运行 jenkins 时，会把 web 应用程序解压到这个目录")])]),n._v(" "),e("p",[n._v("/var/log/jenkins/jenkins.log jenkins日志文件。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("tail -f /var/log/jenkins/jenkins.log\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br")])]),e("p",[n._v("/etc/sysconfig/jenkins #配置文件，“端口”，“JENKINS_HOME”等都可以在这里配置。")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("cat /etc/sysconfig/jenkins\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br")])]),e("p",[n._v("修改内存限制，编辑/etc/sysconfig/jenkins")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('vi /etc/sysconfig/jenkins\nJENKINS_JAVA_OPTIONS="-Xmx2048m -Djava.awt.headless=true"\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);