(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{1143:function(s,n,a){"use strict";a.r(n);var e=a(1),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_36-4-递归-可以调用自己的脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_36-4-递归-可以调用自己的脚本"}},[s._v("#")]),s._v(" 36.4 递归：可以调用自己的脚本")]),s._v(" "),a("p",[s._v("脚本可以递归的调用自己吗？答案是肯定的。")]),s._v(" "),a("h2",{attrs:{id:"example-36-10-可以调用自己的脚本-但没什么实际用途"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example-36-10-可以调用自己的脚本-但没什么实际用途"}},[s._v("#")]),s._v(" Example 36-10. 可以调用自己的脚本（但没什么实际用途）")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\n# recurse.sh\n\n# 脚本可以调用自己吗？\n# 其实是可以的。但这样有什么实际用途吗？\n# （请往下看）\n\nRANGE=10\nMAXVAL=9\n\ni=$RANDOM\nlet "i %= $RANGE"  # 在0到$RANGE - 1的范围内产生一个随机数\n\nif [ "$i" -lt "$MAXVAL" ]\nthen\n    echo "i = $i"\n    ./$0           # 脚本进行递归调用（调用自己）\nfi                 # 每次被调用的脚本做同样的事情，直到$i和$MAXVAL相等。 \n\n# 如果使用“while”循环代替“if/then”语句会出问题。请试着解释为什么。\n\nexit 0\n\n# 笔记:\n# ----\n# 这个脚本文件必须有可执行权限。\n# 即使使用“sh”命令调用，这脚本也可以执行。\n# 请解释原因。\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("h2",{attrs:{id:"example-36-11-一个有点用的调用自己的脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example-36-11-一个有点用的调用自己的脚本"}},[s._v("#")]),s._v(" Example 36-11. 一个有点用的调用自己的脚本")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\n# pb.sh: phone book\n\n# 用于权限管理的脚本，由Rick Boivie编写。\n# ABS作者稍有修改\n\nMINARGS=1     # 需要至少一个参数\nDATAFILE=./phonebook\n              # 当前目录下必须存在名为“phonebook”的数据文件\nPROGNAME=$0\nE_NOARGS=70   # 没有错误\n\nif [ $# -lt $MINARGS ]; then\n    echo "Usage: "$PROGNAME" data-to-look-up"\n    exit $E_NOARGS\nfi      \n\nif [ $# -eq $MINARGS ]; then\n    grep $1 "$DATAFILE"\n    # 如果$DATAFILE没有匹配则\'grep\'命令会报错。\nelse\n    ( shift; "$PROGNAME" $* ) | grep $1\n    # 脚本的递归调用\nfi\nexit 0        # 脚本结束 \n\n# 下面是一些文件内容\n\n# ------------------------------------------------------------------------\n一个简单的"phonebook"数据文件:\n\nJohn Doe        1555 Main St., Baltimore, MD 21228          (410) 222-3333\nMary Moe        9899 Jones Blvd., Warren, NH 03787          (603) 898-3232\nRichard Roe     856 E. 7th St., New York, NY 10009          (212) 333-4567\nSam Roe         956 E. 8th St., New York, NY 10009          (212) 444-5678\nZoe Zenobia     4481 N. Baker St., San Francisco, SF 94338  (415) 501-1631\n# ------------------------------------------------------------------------\n\n$bash pb.sh Roe\nRichard Roe     856 E. 7th St., New York, NY 10009          (212) 333-4567\nSam Roe         956 E. 8th St., New York, NY 10009          (212) 444-5678\n\n$bash pb.sh Roe Sam\nSam Roe         956 E. 8th St., New York, NY 10009          (212) 444-5678\n\n# 当对脚本传入多于一个参数时，脚本只显示包含所有参数的行\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br")])]),a("h2",{attrs:{id:"example-36-12-另一个调用自己的脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example-36-12-另一个调用自己的脚本"}},[s._v("#")]),s._v(" Example 36-12. 另一个调用自己的脚本")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#!/bin/bash\n# usrmnt.sh, 由Anthony Richardson编写\n# 在ABS Guide中用于权限管理\n\n# usage:       usrmnt.sh\n# description: 想使用挂载设备操作的用户，在/etc/sudoers文件中必须属于MNTUSERS组。\n\n# ----------------------------------------------------------\n# 这个脚本会返回加了sudo命令的自身。\n# 如果一个有权限的用户，则只需要输入：\n#   usermount /dev/fd0 /mnt/floppy\n# 而不需要使用下面的方法：\n#   sudo usermount /dev/fd0 /mnt/floppy\n\n# 我对于所有需要sudo的脚本都使用了这个技术，因为我发现这让我感觉非常舒服。\n# ----------------------------------------------------------\n\n# 如果SUDO_COMMAND变量没有被设置，那证明没有使用sudo命令运行。这需要\n# 再重新运行这个脚本，同时传递用户的ID和组ID...\n\nif [ -z "$SUDO_COMMAND" ]\nthen\n    mntusr=$(id -u) grpusr=$(id -g) sudo $0 $* # 译注：脚本调用自己，并且传递参数\n    exit 0\nfi\n\n# 如果使用了sudo运行，就不会卡在这里了。\n/bin/mount $* -o uid=$mntusr,gid=$grpusr\n\nexit 0\n\n# 附加说明：\n# -------------------------------------------------\n\n# 1) Linux系统允许/etc/fstab文件中列出的用户挂在移动存储设备。但在服务器上，我喜欢让更少的人访问移动存储。我发现使用sudo可以帮我做到。\n\n# 2) 我还发现使用sudo比用组权限来实现让人感觉更加舒服。\n\n# 3) 这种方法可以给任何有权限的人使用mount命令，所以要小心处理。\n#    你也可以将这种技术用到比如mntfloppy，mntcdrom和mntsamba等脚本上来实现更优雅的挂载管理。\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("p",[s._v("过多层次的递归调用会导致脚本的栈空间溢出，引起段错误（segfault）。")])])}),[],!1,null,null,null);n.default=t.exports}}]);