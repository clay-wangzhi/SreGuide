import{_ as e,e as s}from"./app.250f2715.js";const a={},n=s(`<h1 id="etcd-\u78C1\u76D8\u7A7A\u95F4\u7206\u6EE1\u89E3\u51B3\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#etcd-\u78C1\u76D8\u7A7A\u95F4\u7206\u6EE1\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a> ETCD \u78C1\u76D8\u7A7A\u95F4\u7206\u6EE1\u89E3\u51B3\u65B9\u6848</h1><blockquote><p>etcd\u9ED8\u8BA4\u7684\u7A7A\u95F4\u914D\u989D\u9650\u5236\u4E3A2G\uFF0C\u8D85\u51FA\u7A7A\u95F4\u914D\u989D\u9650\u5236\u5C31\u4F1A\u5F71\u54CD\u670D\u52A1\uFF0C\u6240\u4EE5\u9700\u8981\u5B9A\u671F\u6E05\u7406</p></blockquote><h2 id="\u67E5\u770B\u96C6\u7FA4\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u96C6\u7FA4\u72B6\u6001" aria-hidden="true">#</a> \u67E5\u770B\u96C6\u7FA4\u72B6\u6001</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">ETCDCTL_API</span><span class="token operator">=</span><span class="token number">3</span> etcdctl --cacert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/ca.crt --cert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.crt --key<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.key --endpoints<span class="token operator">=</span>https://10.100.142.163:2379 --write-out<span class="token operator">=</span>table endpoint status
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u67E5\u770BETCD\u96C6\u7FA4\u62A5\u8B66\u60C5\u51B5</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">ETCDCTL_API</span><span class="token operator">=</span><span class="token number">3</span> etcdctl --cacert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/ca.crt --cert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.crt --key<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.key --endpoints<span class="token operator">=</span>https://10.100.142.163:2379 alarm list
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u8F93\u51FA\u4E3A\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>meberID:XXXXXXXXXXXXXXX alarm:NOSPACE
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>\u6B64\u5904 <code>alarm</code> \u63D0\u793A <code>NOSPACE</code>\uFF0C\u9700\u8981\u5347\u7EA7 ETCD \u96C6\u7FA4\u7684\u7A7A\u95F4\uFF08\u9ED8\u8BA4\u4E3A2G\u7684\u78C1\u76D8\u4F7F\u7528\u7A7A\u95F4\uFF09\uFF0C\u6216\u8005\u538B\u7F29\u8001\u6570\u636E\uFF0C\u5347\u7EA7\u7A7A\u95F4\u540E\uFF0C\u9700\u8981\u4F7F\u7528 etcd\u547D\u4EE4\uFF0C\u53D6\u6D88\u6B64\u62A5\u8B66\u4FE1\u606F\uFF0C\u5426\u5219\u96C6\u7FA4\u4F9D\u65E7\u65E0\u6CD5\u4F7F\u7528</p></blockquote><h2 id="\u589E\u52A0etcd\u7684\u5BB9\u91CF" tabindex="-1"><a class="header-anchor" href="#\u589E\u52A0etcd\u7684\u5BB9\u91CF" aria-hidden="true">#</a> \u589E\u52A0etcd\u7684\u5BB9\u91CF</h2><p>\u4FEE\u6539 etcd.yaml \u6587\u4EF6\uFF0C\u75312G--&gt;8G,\u589E\u52A0\u4EE5\u4E0B\u4E09\u4E2A\u53C2\u6570</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>- --auto-compaction-mode<span class="token operator">=</span>revision
- --auto-compaction-retention<span class="token operator">=</span><span class="token number">1000</span>
- --quota-backend-bytes<span class="token operator">=</span><span class="token number">8589934592</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>auto-compaction-mode=revision \u6309\u7248\u672C\u53F7\u538B\u7F29</p><p>auto-compaction-retention=1000 \u4FDD\u7559\u8FD11000\u4E2Arevision\uFF0C\u6BCF5\u5206\u949F\u81EA\u52A8\u538B\u7F29 \u201Dlatest revision\u201D - 1000</p><p>quota-backend-bytes \u8BBE\u7F6Eetcd\u6700\u5927\u5BB9\u91CF\u4E3A8G</p></blockquote><h2 id="\u538B\u7F29\u8001\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#\u538B\u7F29\u8001\u6570\u636E" aria-hidden="true">#</a> \u538B\u7F29\u8001\u6570\u636E</h2><ul><li>\u83B7\u53D6\u5F53\u524Detcd\u6570\u636E\u7684\u4FEE\u8BA2\u7248\u672C(revision)</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">rev</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token assign-left variable">ETCDCTL_API</span><span class="token operator">=</span><span class="token number">3</span> etcdctl  --cacert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/ca.crt --cert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.crt --key<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.key --endpoints<span class="token operator">=</span>https://10.100.142.163:2379 endpoint status --write-out<span class="token operator">=</span><span class="token string">&quot;json&quot;</span> <span class="token operator">|</span> <span class="token function">egrep</span> -o <span class="token string">&#39;&quot;revision&quot;:[0-9]*&#39;</span> <span class="token operator">|</span> <span class="token function">egrep</span> -o <span class="token string">&#39;[0-9].*&#39;</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token variable">$rev</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>\u6574\u5408\u538B\u7F29\u65E7\u7248\u672C\u6570\u636E</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">ETCDCTL_API</span><span class="token operator">=</span><span class="token number">3</span> etcdctl --cacert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/ca.crt --cert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.crt --key<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.key --endpoints<span class="token operator">=</span>https://10.100.142.163:2379 compact <span class="token variable">$rev</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>\u6267\u884C\u788E\u7247\u6574\u7406</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">ETCDCTL_API</span><span class="token operator">=</span><span class="token number">3</span> etcdctl --cacert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/ca.crt --cert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.crt --key<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.key --endpoints<span class="token operator">=</span>https://10.100.142.163:2379 defrag
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="\u89E3\u9664\u544A\u8B66" tabindex="-1"><a class="header-anchor" href="#\u89E3\u9664\u544A\u8B66" aria-hidden="true">#</a> \u89E3\u9664\u544A\u8B66</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">ETCDCTL_API</span><span class="token operator">=</span><span class="token number">3</span> etcdctl --cacert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/ca.crt --cert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.crt --key<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.key --endpoints<span class="token operator">=</span>https://10.100.142.163:2379 alarm disarm
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="\u9A8C\u8BC1\u53EF\u4EE5\u6DFB\u52A0\u65B0\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#\u9A8C\u8BC1\u53EF\u4EE5\u6DFB\u52A0\u65B0\u6570\u636E" aria-hidden="true">#</a> \u9A8C\u8BC1\u53EF\u4EE5\u6DFB\u52A0\u65B0\u6570\u636E</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">ETCDCTL_API</span><span class="token operator">=</span><span class="token number">3</span> etcdctl --cacert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/ca.crt --cert<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.crt --key<span class="token operator">=</span>/etc/kubernetes/pki/etcd/server.key --endpoints<span class="token operator">=</span>https://10.100.142.163:2379 put newkeytestfornospace <span class="token number">123</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p>\u26A0\uFE0F auto compact\u53EA\u4F1A\u538B\u7F29key space\uFF0C\u4E0D\u4F1A\u91CA\u653E\u7269\u7406\u5B58\u50A8\u7A7A\u95F4\u3002\u6240\u4EE5\u9700\u8981\u5B9A\u671F\u7684\u6267\u884Cdefrag</p></blockquote>`,25);function t(r,p){return n}var o=e(a,[["render",t],["__file","etcd-defrag.html.vue"]]);export{o as default};
